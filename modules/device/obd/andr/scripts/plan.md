# План нормализации PID-таблиц

Этот документ фиксирует процесс подготовки собственных JSON-справочников вместо GPL-поставки.

## 1. Источники

- SAE J1979 (OBD-II), ISO 15031-5 — базовые PID режимов 0x01/0x02/0x03/0x09.
- Публичные базы PID (например, OpenXC, wikipedia по OBD).
- Производственные мануалы (для VAG, Toyota и т. д.) — только если доступны на законных основаниях.

## 2. Шаги

1. Составить перечень обязательных PID для услуг диагностики (обороты двигателя, скорость, MIL, DTC и т. д.).
2. Сравнить с полями из `packages/andr-obd-import/library/.../pids.csv`, определить пересечения и уникальные поля.
3. Для каждого выбранного PID найти подтверждение в открытых источниках, записать ссылку.
4. Сформировать собственный JSON (`data/pids.json`) по типу:

    ```json
    {
      "mode": "0x01",
      "pid": "0x0C",
      "label": "Engine RPM",
      "unit": "rpm",
      "min": 0,
      "max": 8000,
      "formula": "((A*256)+B)/4",
      "notes": "SAE J1979-DA, таблица 7"
    }
    ```
   ```
5. Аналогично подготовить файл `data/conversions.json` для формул и единиц измерения.
6. Для нестандартных PID (OEM) завести отдельный `data/pids-oem.json` с явными ссылками на источники.
7. Сформировать отчёт о расхождениях между оригинальным CSV и нашей таблицей (например, `outbox/pids-diff.json`).

## 3. Артефакты

- `src/pids/catalog.ts` будет загружать наш JSON.
- Дополнительные тесты (`src/pids/catalog.test.ts`) проверят что PID доступны и формулы заданы.

## 4. Ограничения

- Никакое копирование текста/формул из GPL-таблиц без подтверждения из свободных источников.
- Для спорных PID — оставить заглушку и комментарий "требует проверки".

## 5. Контроль

- После заполнения JSON добавить в `package.json` скрипты валидации и тестов.
- Обновить документацию (`README.md`, `docs/tech/diagnostics.md`) с описанием собственных таблиц.
