# STRIDE Threat Model ‚Äî –ú–æ–¥–µ–ª—å —É–≥—Ä–æ–∑ –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ STRIDE

## –ß—Ç–æ —Ç–∞–∫–æ–µ STRIDE?

STRIDE ‚Äî –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —É–≥—Ä–æ–∑, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Microsoft. –ê–∫—Ä–æ–Ω–∏–º –æ–∑–Ω–∞—á–∞–µ—Ç:

- **S**poofing (–ü–æ–¥–º–µ–Ω–∞) ‚Äî –∞—Ç–∞–∫–∞ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- **T**ampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è) ‚Äî –∞—Ç–∞–∫–∞ –Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **R**epudiation (–û—Ç–∫–∞–∑) ‚Äî –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **I**nformation Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏) ‚Äî –∞—Ç–∞–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å
- **D**enial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏) ‚Äî –∞—Ç–∞–∫–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- **E**levation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π) ‚Äî –∞—Ç–∞–∫–∞ –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã (–∫–æ–Ω—Ç–µ–∫—Å—Ç)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∏–æ—Å–∫–∞ —Å–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

1. **Kiosk Frontend** ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π UI (HTML/CSS/JS)
2. **Kiosk Agent** ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π Node.js —Å–µ—Ä–≤–∏—Å
3. **Cloud API** ‚Äî –æ–±–ª–∞—á–Ω—ã–π REST API
4. **Supabase** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ backend
5. **Payment Provider** ‚Äî –ø–ª–∞—Ç—ë–∂–Ω—ã–π —à–ª—é–∑ (–ÆKassa)
6. **OBD-II Device** ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–¥–∞–ø—Ç–µ—Ä
7. **Thickness Meter** ‚Äî —Ç–æ–ª—â–∏–Ω–æ–º–µ—Ä
8. **Device Locks** ‚Äî –∑–∞–º–∫–∏ –≤—ã–¥–∞—á–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

- Frontend ‚Üî Agent (HTTP)
- Agent ‚Üî Cloud API (HTTP)
- Agent ‚Üî Supabase (PostgreSQL over TLS)
- Agent ‚Üî Payment Provider (HTTPS)
- Agent ‚Üî OBD Device (Serial/Bluetooth)
- Agent ‚Üî Thickness Meter (BLE/SDK)
- Agent ‚Üí Device Locks (GPIO/Serial)

## STRIDE Checklist –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

### 1. Kiosk Frontend

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-F-01**: –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ QR-–∫–æ–¥—ã –æ–ø–ª–∞—Ç—ã
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: QR –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–≥–µ–Ω—Ç–æ–º —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π; –ø—Ä–æ–≤–µ—Ä–∫–∞ payment_id –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
- [ ] **S-F-02**: –ü–æ–¥–¥–µ–ª–∫–∞ UI (—Ñ–∏—à–∏–Ω–≥-—ç–∫—Ä–∞–Ω—ã)
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ö–∏–æ—Å–∫-—Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞; –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤; CSP headers

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-F-01**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ JavaScript –≤ DevTools
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∞–≥–µ–Ω—Ç–∞/API; DEV-—Ñ–ª–∞–≥–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ PROD
- [ ] **T-F-02**: –ü–æ–¥–º–µ–Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Subresource Integrity (SRI) –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫; HTTPS —Å –≤–∞–ª–∏–¥–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-F-01**: –ö–ª–∏–µ–Ω—Ç –æ—Ç—Ä–∏—Ü–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –≤ UI
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–Ω–∞—á–∏–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–∫–ª–∏–∫ "–û–ø–ª–∞—Ç–∏—Ç—å", "–°–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å–ª–æ–≤–∏—è–º–∏")

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-F-01**: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ LocalStorage/SessionStorage
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (source=agent/supabase)
- [ ] **I-F-02**: –°–µ–∫—Ä–µ—Ç—ã –≤ JavaScript
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–æ–ª—å–∫–æ ANON_KEY –¥–ª—è —á—Ç–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω—ã—Ö VIEW; SERVICE_ROLE_KEY —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-F-01**: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ê–≤—Ç–æ-—Å–±—Ä–æ—Å —Å–µ—Å—Å–∏–∏ –ø–æ —Ç–∞–π–º–∞—É—Ç—É; –æ—á–∏—Å—Ç–∫–∞ state –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-F-01**: –î–æ—Å—Ç—É–ø –∫ admin-—Ñ—É–Ω–∫—Ü–∏—è–º –∏–∑ UI
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫—Ä—ã—Ç—ã (Ctrl+Shift+S —Ç–æ–ª—å–∫–æ –≤ DEV); –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ frontend

---

### 2. Kiosk Agent

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-A-01**: –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ webhook'–∏ –æ—Ç Payment Provider
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: HMAC verification —Å PROVIDER_WEBHOOK_SECRET
- [ ] **S-A-02**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (OBD/—Ç–æ–ª—â–∏–Ω–æ–º–µ—Ä)
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Whitelist MAC-–∞–¥—Ä–µ—Å–æ–≤/–ø–æ—Ä—Ç–æ–≤; –¥—Ä–∞–π–≤–µ—Ä—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-A-01**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤/–æ—Ç—á—ë—Ç–æ–≤
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Append-only –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ; –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤
- [ ] **T-A-02**: –ü–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö OBD/—Ç–æ–ª—â–∏–Ω–æ–º–µ—Ä–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞; –¥–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—â–∏–Ω–∞ > 5000 –º–∫–º)

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-A-01**: –û–ø–µ—Ä–∞—Ç–æ—Ä –æ—Ç—Ä–∏—Ü–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è (—Ä—É—á–Ω–∞—è –≤—ã–¥–∞—á–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ê—É–¥–∏—Ç-–ª–æ–≥–∏ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ operator_id

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-A-01**: –°–µ–∫—Ä–µ—Ç—ã –≤ –ª–æ–≥–∞—Ö
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Redact —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ª–æ–≥–≥–µ—Ä–µ; YOOKASSA_SECRET_KEY, SUPABASE_SERVICE_ROLE_KEY –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- [ ] **I-A-02**: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ; —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SQLite; –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-A-01**: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤/–ø–∞–º—è—Ç–∏
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: LOG_MAX_ENTRIES, LOG_ROTATE_AFTER_MS; graceful shutdown
- [ ] **D-A-02**: –ó–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö I/O; retry —Å exponential backoff

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-A-01**: –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ —Å root/admin –ø—Ä–∞–≤–∞–º–∏
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –†–∞–±–æ—Ç–∞ –ø–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —É—á—ë—Ç–∫–æ–π; —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ (serial port, USB)

---

### 3. Cloud API

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-C-01**: –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: API –∫–ª—é—á–∏ –∏–ª–∏ JWT tokens; CORS whitelist

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-C-01**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ transit
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: HTTPS/TLS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ; HSTS header

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-C-01**: –ö–ª–∏–µ–Ω—Ç –æ—Ç—Ä–∏—Ü–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å—ã
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å IP, User-Agent, timestamp

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-C-01**: –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ API
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã—Ö VIEW; –≤–∞–ª–∏–¥–∞—Ü–∏—è input/output schemas (Zod)

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-C-01**: DDoS –∞—Ç–∞–∫–∞ –Ω–∞ API
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Rate limiting (express-rate-limit); WAF/Cloudflare

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-C-01**: –î–æ—Å—Ç—É–ø –∫ admin endpoints –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Role-based access control; /metrics, /admin –∑–∞—â–∏—â–µ–Ω—ã

---

### 4. Supabase (Database)

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-DB-01**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º–∏ credentials
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Service role key —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö; TLS –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-DB-01**: SQL injection
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Parameterized queries; ORM (Supabase client); input validation
- [ ] **T-DB-02**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ anon key
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: RLS policies; anon –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ SELECT –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö VIEW

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-DB-01**: –û—Ç—Ä–∏—Ü–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Audit triggers (created_at, updated_at); pg_audit –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-DB-01**: –ß—Ç–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ anon key
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–∞–º; —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ VIEW

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-DB-01**: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Retention policy –¥–ª—è –ª–æ–≥–æ–≤; –∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-DB-01**: Escalation —á–µ—Ä–µ–∑ SQL
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: RLS –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö; –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è service_role

---

### 5. Payment Provider

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-P-01**: –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ webhook'–∏
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: HMAC verification; IP whitelist (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-P-01**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É–º–º—ã –ø–ª–∞—Ç–µ–∂–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –°—É–º–º–∞ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ createIntent; –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ webhook

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-P-01**: –ö–ª–∏–µ–Ω—Ç –æ—Å–ø–∞—Ä–∏–≤–∞–µ—Ç –ø–ª–∞—Ç—ë–∂
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ payment_id, timestamps; —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–≤–∏—Ç–∞–Ω—Ü–∏–π

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-P-01**: –£—Ç–µ—á–∫–∞ YOOKASSA_SECRET_KEY
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ vault; –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å; —Ä–æ—Ç–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 180 –¥–Ω–µ–π

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-P-01**: –ü—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Retry —Å exponential backoff; fallback –Ω–∞ —Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø–ª–∞—Ç–µ–∂–µ–π

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-P-01**: –î–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º –ø–ª–∞—Ç–µ–∂–∞–º —á–µ—Ä–µ–∑ API
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ ownership (session_id, payment_id)

---

### 6. OBD-II Device & Thickness Meter

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-D-01**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Whitelist MAC/–ø–æ—Ä—Ç–æ–≤; –ø—Ä–æ–≤–µ—Ä–∫–∞ firmware version

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-D-01**: –ü–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞; –¥–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π; –ø—Ä–æ–≤–µ—Ä–∫–∞ checksums

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-D-01**: –û—Ç—Ä–∏—Ü–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ raw data; timestamps; –ø—Ä–∏–≤—è–∑–∫–∞ –∫ session_id

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-D-01**: –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Bluetooth
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: BLE pairing; encryption –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-D-01**: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∞–µ—Ç/–æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Watchdog; retry; clear error messages –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-D-01**: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Whitelist —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥; –∏–∑–æ–ª—è—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤

---

### 7. Device Locks (–ó–∞–º–∫–∏)

#### Spoofing (–ü–æ–¥–º–µ–Ω–∞)
- [ ] **S-L-01**: –ü–æ–¥–¥–µ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∑–∞–º–∫–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ö–æ–º–∞–Ω–¥—ã —Ç–æ–ª—å–∫–æ –æ—Ç –∞–≥–µ–Ω—Ç–∞; —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

#### Tampering (–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **T-L-01**: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–µ –≤–∑–ª–∞–º—ã–≤–∞–Ω–∏–µ
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –§–∏–∑–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞; –∞–ª–µ—Ä—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –±–µ–∑ –∫–æ–º–∞–Ω–¥—ã (–¥–∞—Ç—á–∏–∫–∏)

#### Repudiation (–û—Ç–∫–∞–∑)
- [ ] **R-L-01**: –û–ø–µ—Ä–∞—Ç–æ—Ä –æ—Ç—Ä–∏—Ü–∞–µ—Ç –≤—ã–¥–∞—á—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ openSlot/closeSlot —Å timestamps

#### Information Disclosure (–†–∞—Å–∫—Ä—ã—Ç–∏–µ)
- [ ] **I-L-01**: ‚Äî
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ

#### Denial of Service (–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
- [ ] **D-L-01**: –ó–∞–º–æ–∫ –∑–∞–∫–ª–∏–Ω–∏–≤–∞–µ—Ç
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π bypass; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è; –∞–ª–µ—Ä—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º

#### Elevation of Privilege (–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)
- [ ] **E-L-01**: –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±–µ–∑ –æ–ø–ª–∞—Ç—ã
  - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –í—ã–¥–∞—á–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞; –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

| ID | –£–≥—Ä–æ–∑–∞ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|-------------|---------|-----------|--------|
| S-A-01 | –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ webhook'–∏ | Agent | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | **–ö—Ä–∏—Ç–∏—á–Ω—ã–π** | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |
| I-A-01 | –°–µ–∫—Ä–µ—Ç—ã –≤ –ª–æ–≥–∞—Ö | Agent | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–Ω–∞—è | **–ö—Ä–∏—Ç–∏—á–Ω—ã–π** | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |
| T-DB-02 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ anon | Database | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–Ω–∞—è | **–í—ã—Å–æ–∫–∏–π** | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |
| E-A-01 | –ó–∞–ø—É—Å–∫ —Å root | Agent | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è | **–í—ã—Å–æ–∫–∏–π** | üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ |
| D-A-02 | –ó–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö | Agent | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |
| T-D-01 | –ü–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ | Device | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–∏–π | üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ |
| D-C-01 | DDoS –Ω–∞ API | Cloud API | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |
| E-L-01 | –í—ã–¥–∞—á–∞ –±–µ–∑ –æ–ø–ª–∞—Ç—ã | Locks | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è | **–í—ã—Å–æ–∫–∏–π** | ‚úÖ –ú–∏—Ç–∏–≥–∏—Ä–æ–≤–∞–Ω–æ |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
1. ‚úÖ –í–∫–ª—é—á–∏—Ç—å RLS –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HMAC verification –¥–ª—è webhook'–æ–≤
3. ‚úÖ Redact —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ª–æ–≥–∞—Ö
4. ‚úÖ Rate limiting –Ω–∞ API
5. üîÑ –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ –ø–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —É—á—ë—Ç–∫–æ–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã
1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ hardware security module (HSM) –¥–ª—è –∫–ª—é—á–µ–π
2. Penetration testing –ø–µ—Ä–µ–¥ production launch
3. Bug bounty –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
4. –†–µ–≥—É–ª—è—Ä–Ω—ã–µ security audits (–µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ)

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `08-security/01-interfaces/policies/` ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `08-security/05-tests/` ‚Äî —á–µ–∫–ª–∏—Å—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `09-docs/01-interfaces/docs-root/tech/CYCLE2_SECURITY_GUIDE.md` ‚Äî –≥–∏–¥ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `09-docs/01-interfaces/docs-root/internal/structure/blocks/threat-matrix/` ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —É–≥—Ä–æ–∑

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è:
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü–æ—Å–ª–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –ú–∏–Ω–∏–º—É–º —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª (review)

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2024-12  
**–ê–≤—Ç–æ—Ä:** Security Team
