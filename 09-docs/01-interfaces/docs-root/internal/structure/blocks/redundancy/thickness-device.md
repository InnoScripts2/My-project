# Резервирование: модуль толщиномера

## Цель

Поддерживать услугу толщинометрии, даже если основной датчик недоступен.

## Инвентарь

- Основной толщиномер: `device-thickness-primary` (BLE/USB, серийный № фиксируем в журнале).
- Резервный датчик: `device-thickness-backup`, хранится в запломбированном отсеке.
- Зарядные станции и комплект сменных аккумуляторов.

## Триггеры переключения

- Отсутствие соединения более 30 секунд после команды соединения.
- Три неуспешных попытки считывания подряд.
- Жалоба клиента на некорректные показания (с вербальной фиксацией).

## Алгоритм перехода на резерв

1. Зафиксировать инцидент в `logs/device-thickness.log` с кодом `FAIL_PRIMARY`.
2. Отключить основной датчик (команда `shutdown`).
3. Разблокировать отсек с резервным датчиком через `LockController`.
4. Выполнить процедуру `pairBackupDevice()` (см. TODO в `apps/kiosk-agent`).
5. Провести тестовую калибровку на эталонной пластине.
6. Перевести UI в режим «Резервное устройство активировано».

## Возврат к основному датчику

- После окончания сессии выполнить полную диагностику основного датчика.
- Если тесты пройдены, вернуть его в основную роль, резервный — зарядить и опечатать.

## Требуемые задачи

- Реализовать в `ObdConnectionManager` аналог техпроцесса для толщиномера (`ThicknessConnectionManager`).
- Подготовить инструкцию по физической замене (в `docs/internal/training/`).
- Обновить экран мониторинга, чтобы операторы видели режим (`primary`/`backup`).
